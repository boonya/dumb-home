language: node_js
node_js:
  - 12.16.1
arch:
  - amd64
os: linux
dist: bionic

before_install:
  - curl https://install.meteor.com | /bin/sh
install:
  - npm install
jobs:
  include:
    - stage: "Lint & Test"
      script: npm run lint
    - script: npm run test
    - stage: GitHub Release
      if: branch = master && type != pull_request
      script: npm run build
      deploy:
        provider: releases
        api_key: $GITHUB_OAUTH_TOKEN
        file:
          - build/app.tar.gz
          - build/installDeps.sh
        skip_cleanup: true
        draft: true
branches:
  only:
    - master
